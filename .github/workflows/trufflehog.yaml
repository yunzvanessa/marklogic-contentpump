name: TruffleHog Secret Scan
on:  
  workflow_dispatch:  
  pull_request:    
    branches: 
      - '*develop*'

jobs:
  TruffleHog:    
    runs-on: ubuntu-latest    
    steps:      
      - name: Checkout code        
        uses: actions/checkout@v4        
        with:          
          fetch-depth: 0
      
      - name: TruffleHog Secret Scan        
        uses: trufflesecurity/trufflehog@main        
        with:          
          base: ${{ github.event.pull_request.base.sha }}
          head: ${{ github.event.pull_request.head.sha }}
        continue-on-error: false